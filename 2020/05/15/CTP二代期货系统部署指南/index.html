<!DOCTYPE html>



  


<html class="theme-next muse use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta name="description" content="CTP 二代期货系统部署指南系统基础环境搭建 未特别说明, 则所有机器均配置   db, trade1, trade2, config 安装 redhat 6.9  关闭开机启动项 和 selinux 123chkconfig NetworkManager offchkconfig iptables offsed -i &#39;s&#x2F;SELINUX&#x3D;enforcing&#x2F;SELINUX&#x3D;disabled&#x2F;g">
<meta property="og:type" content="article">
<meta property="og:title" content="CTP二代期货系统部署指南">
<meta property="og:url" content="https://blog.kkkingim.com/2020/05/15/CTP%E4%BA%8C%E4%BB%A3%E6%9C%9F%E8%B4%A7%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E6%8C%87%E5%8D%97/index.html">
<meta property="og:site_name" content="Vagitus&#39; Blog">
<meta property="og:description" content="CTP 二代期货系统部署指南系统基础环境搭建 未特别说明, 则所有机器均配置   db, trade1, trade2, config 安装 redhat 6.9  关闭开机启动项 和 selinux 123chkconfig NetworkManager offchkconfig iptables offsed -i &#39;s&#x2F;SELINUX&#x3D;enforcing&#x2F;SELINUX&#x3D;disabled&#x2F;g">
<meta property="article:published_time" content="2020-05-16T03:48:52.681Z">
<meta property="article:modified_time" content="2020-05-28T18:28:31.282Z">
<meta property="article:author" content="Vagitus">
<meta name="twitter:card" content="summary">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Muse',
    version: '5.1.4',
    sidebar: {"position":"left","display":"post","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="https://blog.kkkingim.com/2020/05/15/CTP二代期货系统部署指南/"/>





  <title>CTP二代期货系统部署指南 | Vagitus' Blog</title>
  








<meta name="generator" content="Hexo 4.2.0"></head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left page-post-detail">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">Vagitus' Blog</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle"></p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/%20" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/%20" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            

  <div id="posts" class="posts-expand">
    

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="https://blog.kkkingim.com/2020/05/15/CTP%E4%BA%8C%E4%BB%A3%E6%9C%9F%E8%B4%A7%E7%B3%BB%E7%BB%9F%E9%83%A8%E7%BD%B2%E6%8C%87%E5%8D%97/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="Vagitus">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="/images/avatar.gif">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="Vagitus' Blog">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">CTP二代期货系统部署指南</h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2020-05-15T23:48:52-04:00">
                2020-05-15
              </time>
            

            

            
          </span>

          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        <h1 id="CTP-二代期货系统部署指南"><a href="#CTP-二代期货系统部署指南" class="headerlink" title="CTP 二代期货系统部署指南"></a>CTP 二代期货系统部署指南</h1><h2 id="系统基础环境搭建"><a href="#系统基础环境搭建" class="headerlink" title="系统基础环境搭建"></a>系统基础环境搭建</h2><blockquote>
<p>未特别说明, 则所有机器均配置</p>
</blockquote>
<ol>
<li><p><code>db</code>, <code>trade1</code>, <code>trade2</code>, <code>config</code> 安装 redhat 6.9</p>
</li>
<li><p>关闭开机启动项 和 selinux</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">chkconfig NetworkManager off</span><br><span class="line">chkconfig iptables off</span><br><span class="line">sed -i 's/SELINUX=enforcing/SELINUX=disabled/g' /etc/selinux/config</span><br></pre></td></tr></table></figure>

<p>重启生效</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">reboot</span><br></pre></td></tr></table></figure>

<p>重启后检查 检查 <code>selinux</code> 是否关闭</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">getenforce</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>db</code> 配置 <code>/etc/hosts</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">172.0.0.10 db sjqh1</span><br></pre></td></tr></table></figure>
</li>
<li><p>根据 <code>附录1</code> 配置网络</p>
<p><code>‌vi /etc/sysconfig/network-scripts/ifcfg-eth{n}</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">DEVICE=eth&#123;n&#125;</span><br><span class="line">HWADDR=XX:XX:XX:XX:XX:XX</span><br><span class="line">TYPE=Ethernet</span><br><span class="line">ONBOOT=yes</span><br><span class="line">NM_CONTROLLED=yes</span><br><span class="line">BOOTPROTO=static</span><br><span class="line">IPADDR=172.0.0.10</span><br><span class="line">NETMASK=255.255.255.0</span><br></pre></td></tr></table></figure>

<p>配置完成重启网络</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">service network restart</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置 yum 源</p>
<p>连接光盘 💿 映像文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">mount /dev/cdrom /mnt</span><br><span class="line">rm -rf /opt/redhat6</span><br><span class="line">mkdir /opt/redhat6</span><br><span class="line">cp -rp /mnt/* /opt/redhat6</span><br><span class="line"></span><br><span class="line">cat &gt; /etc/yum.repos.d/base.repo &lt;&lt;EOF</span><br><span class="line">[redhat]</span><br><span class="line">name=redhat</span><br><span class="line">baseurl=file:///opt/redhat6</span><br><span class="line">enabled=1</span><br><span class="line">gpgcheck=0</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">yum clean all</span><br><span class="line">yum makecache</span><br></pre></td></tr></table></figure>

<p>安装工具, 依赖</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">yum install -y openssh-clients dos2unix unzip libaio</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h2 id="数据库-柜台部署"><a href="#数据库-柜台部署" class="headerlink" title="数据库,柜台部署"></a>数据库,柜台部署</h2><h3 id="安装-oracle-数据库"><a href="#安装-oracle-数据库" class="headerlink" title="安装 oracle 数据库"></a>安装 oracle 数据库</h3><blockquote>
<p><strong><em>root 用户</em></strong></p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 创建组</span></span><br><span class="line">groupadd oinstall</span><br><span class="line">groupadd dba</span><br><span class="line">groupadd oper</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 创建用户, 设置密码</span></span><br><span class="line">useradd -g oinstall -G dba,oper -d /home/oracle oracle</span><br><span class="line">echo 'oracle:oracle' | chpasswd</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 建目录</span></span><br><span class="line">mkdir -p /u01/app/oracle/product/11.2.0/db_1</span><br><span class="line">mkdir -p /u02/arch</span><br><span class="line">mkdir -p /u02/software</span><br><span class="line">mkdir -p /u02/dumpdp</span><br><span class="line">mkdir -p /u02/sjqh</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置权限</span></span><br><span class="line">chown -R oracle:oinstall /u01</span><br><span class="line">chown -R oracle:oinstall /u02</span><br><span class="line">chmod -R 775 /u01</span><br><span class="line">chmod -R 775 /u02</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 设置环境变量</span></span><br><span class="line">cat &gt; /home/oracle/.bash_profile &lt;&lt;"EOF"</span><br><span class="line">if [ -f ~/.bashrc ]; then</span><br><span class="line">   . ~/.bashrc</span><br><span class="line">fi</span><br><span class="line">export ORACLE_BASE=/u01/app/oracle</span><br><span class="line">export ORACLE_HOME=/u01/app/oracle/product/11.2.0/db_1</span><br><span class="line">export LD_LIBRARY_PATH=$ORACLE_HOME/lib:.</span><br><span class="line">export NLS_LANG=American_america.ZHS16GBK</span><br><span class="line">export PATH=$PATH:$ORACLE_HOME/bin:.</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 系统参数配置</span></span><br><span class="line">cat &gt;&gt; /etc/sysctl.conf &lt;&lt;EOF</span><br><span class="line">fs.aio-max-nr = 1048576</span><br><span class="line">fs.file-max = 6815744</span><br><span class="line">kernel.shmall = 2097152</span><br><span class="line">kernel.shmmax = 4294967295</span><br><span class="line">kernel.shmmni = 4096</span><br><span class="line">kernel.sem = 250 32000 100 128</span><br><span class="line">net.ipv4.ip_local_port_range = 9000 65500</span><br><span class="line">net.core.rmem_default = 262144</span><br><span class="line">net.core.rmem_max = 4194304</span><br><span class="line">net.core.wmem_default = 262144</span><br><span class="line">net.core.wmem_max = 1048586</span><br><span class="line">EOF</span><br><span class="line">/sbin/sysctl -p</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 文件数和安全设置</span></span><br><span class="line">cat &gt;&gt; /etc/security/limits.conf &lt;&lt;EOF</span><br><span class="line">oracle soft nproc 2047</span><br><span class="line">oracle hard nproc 16384</span><br><span class="line">oracle soft nofile 1024</span><br><span class="line">oracle hard nofile 65536</span><br><span class="line">oracle soft stack 10240</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">cat &gt;&gt; /etc/pam.d/login &lt;&lt;EOF</span><br><span class="line">session required pam_limits.so</span><br><span class="line">session required /lib64/security/pam_limits.so</span><br><span class="line">EOF</span><br></pre></td></tr></table></figure>

<p><strong>上传 <code>p10098816_112020_linux-x86-64_1of7.zip</code> , <code>p10098816_112020_linux-x86-64_2of7.zip</code></strong></p>
<p><strong>到 <code>/u02/software</code></strong></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> 解压安装包</span></span><br><span class="line">cd /u02/software</span><br><span class="line">unzip p13390677_112040_Linux-x86-64_1of7.zip</span><br><span class="line">unzip p13390677_112040_Linux-x86-64_2of7.zip</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 安装依赖</span></span><br><span class="line">yum -y install binutils* compat-libstdc++* elfutils-libelf-* gcc* glibc-* glibc-devel-* glibc-headers* ksh* libaio* libgcc-* libstdc++-* make-* numactl-devel-* sysstat-*</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 确认依赖全部安装</span></span><br><span class="line">rpm -q binutils compat-libstdc++-33 elfutils-libelf elfutils-libelf-devel gcc gcc-c++ glibc glibc-common glibc-devel glibc-headers kernel-headers ksh libaio libaio-devel libgcc libgomp libstdc++ libstdc++-devel make numactl-devel sysstat unixODBC unixODBC-devel | grep "not"</span><br></pre></td></tr></table></figure>

<p>如果有缺少,手动安装缺少的依赖</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> yum install -y ...</span></span><br></pre></td></tr></table></figure>

<blockquote>
<p><strong><em>oracle 用户</em></strong></p>
</blockquote>
<p>安装数据库</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd /u02/software/database; ./runInstaller</span><br></pre></td></tr></table></figure>

<p>安装完成 <strong><code>root</code>用户</strong> 执行脚本</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">/u01/app/oraInventory/orainstRoot.sh</span><br><span class="line">/u01/app/oracle/product/11.2.0/db_1/root.sh</span><br></pre></td></tr></table></figure>

<p>创建数据库</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">dbca</span><br></pre></td></tr></table></figure>

<p>配置 ORACLE_SID</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">echo "export ORACLE_SID=sjqh1" &gt;&gt; /home/oracle/.bash_profile</span><br><span class="line">. /home/oracle/.bash_profile</span><br></pre></td></tr></table></figure>

<p>配置监听</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">netca</span><br></pre></td></tr></table></figure>

<p>数据库配置 运行: <code>sqlplus / as sysdba</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="comment">-- 密码有效期设置为无限制</span></span><br><span class="line"><span class="keyword">alter</span> profile <span class="keyword">default</span> <span class="keyword">limit</span> password_life_time <span class="keyword">unlimited</span>;</span><br><span class="line"><span class="comment">-- 错误密码尝试次数设置为无限制</span></span><br><span class="line"><span class="keyword">alter</span> profile <span class="keyword">default</span> <span class="keyword">limit</span> <span class="keyword">failed_login_attempts</span> <span class="keyword">unlimited</span>;</span><br><span class="line"><span class="comment">-- 关闭审计</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">system</span> <span class="keyword">set</span> audit_trail =<span class="literal">false</span> <span class="keyword">scope</span>=<span class="keyword">spfile</span>;</span><br><span class="line"><span class="comment">-- 忽略大小写</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">system</span> <span class="keyword">set</span> sec_case_sensitive_logon=<span class="literal">false</span> <span class="keyword">scope</span>=<span class="keyword">spfile</span>;</span><br><span class="line"><span class="comment">-- 增加临时表空间容量</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">tablespace</span> temp <span class="keyword">add</span> tempfile <span class="string">'/u01/app/oracle/oradata/sjqh1/temp02.dbf'</span> <span class="keyword">size</span> <span class="number">5</span>G <span class="keyword">autoextend</span> <span class="keyword">on</span>;</span><br><span class="line"><span class="comment">-- 增加UNDO表空间容量</span></span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">tablespace</span> undotbs1 <span class="keyword">add</span> <span class="keyword">datafile</span> <span class="string">'/u01/app/oracle/oradata/sjqh1/undotbs02.dbf'</span> <span class="keyword">size</span> <span class="number">5</span>G <span class="keyword">autoextend</span> <span class="keyword">on</span>;</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 重启数据库</span></span><br><span class="line">shutdown immediate</span><br><span class="line">startup</span><br></pre></td></tr></table></figure>

<h3 id="数据库数据恢复"><a href="#数据库数据恢复" class="headerlink" title="数据库数据恢复"></a>数据库数据恢复</h3><ol>
<li><p>创建表空间</p>
<blockquote>
<p>PLSQL 登录 system 执行下面语句</p>
</blockquote>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLESPACE</span> TBS_SETTLE <span class="keyword">LOGGING</span> <span class="keyword">DATAFILE</span> <span class="string">'/u02/sjqh/TBS_SETTLE.dbf'</span> <span class="keyword">SIZE</span> <span class="number">4096</span>M <span class="keyword">AUTOEXTEND</span> <span class="keyword">ON</span> <span class="keyword">NEXT</span> <span class="number">4096</span>M <span class="keyword">MAXSIZE</span> <span class="keyword">UNLIMITED</span> <span class="keyword">EXTENT</span> <span class="keyword">MANAGEMENT</span> <span class="keyword">LOCAL</span> <span class="keyword">SEGMENT</span> <span class="keyword">SPACE</span> <span class="keyword">MANAGEMENT</span> <span class="keyword">AUTO</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLESPACE</span> TBS_SETTLEADMIN <span class="keyword">LOGGING</span> <span class="keyword">DATAFILE</span> <span class="string">'/u02/sjqh/TBS_SETTLEADMIN.dbf'</span> <span class="keyword">SIZE</span> <span class="number">30720</span>M;</span><br><span class="line"><span class="keyword">alter</span> <span class="keyword">tablespace</span> TBS_SETTLEADMIN <span class="keyword">add</span> <span class="keyword">datafile</span> <span class="string">'/u02/sjqh/TBS_SETTLEADMIN01.dbf'</span> <span class="keyword">size</span> <span class="number">30720</span>M;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLESPACE</span> TBS_TRADEADMIN <span class="keyword">LOGGING</span> <span class="keyword">DATAFILE</span> <span class="string">'/u02/sjqh/TBS_TRADEADMIN.dbf'</span> <span class="keyword">SIZE</span> <span class="number">4096</span>M <span class="keyword">AUTOEXTEND</span> <span class="keyword">ON</span> <span class="keyword">NEXT</span> <span class="number">4096</span>M <span class="keyword">MAXSIZE</span> <span class="keyword">UNLIMITED</span> <span class="keyword">EXTENT</span> <span class="keyword">MANAGEMENT</span> <span class="keyword">LOCAL</span> <span class="keyword">SEGMENT</span> <span class="keyword">SPACE</span> <span class="keyword">MANAGEMENT</span> <span class="keyword">AUTO</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLESPACE</span> TBS_EPAYMENT <span class="keyword">LOGGING</span> <span class="keyword">DATAFILE</span> <span class="string">'/u02/sjqh/TBS_EPAYMENT.dbf'</span> <span class="keyword">SIZE</span> <span class="number">4096</span>M <span class="keyword">AUTOEXTEND</span> <span class="keyword">ON</span> <span class="keyword">NEXT</span> <span class="number">4096</span>M <span class="keyword">MAXSIZE</span> <span class="keyword">UNLIMITED</span> <span class="keyword">EXTENT</span> <span class="keyword">MANAGEMENT</span> <span class="keyword">LOCAL</span> <span class="keyword">SEGMENT</span> <span class="keyword">SPACE</span> <span class="keyword">MANAGEMENT</span> <span class="keyword">AUTO</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLESPACE</span> TBS_EPAYMENT2 <span class="keyword">LOGGING</span> <span class="keyword">DATAFILE</span> <span class="string">'/u02/sjqh/TBS_EPAYMENT2.dbf'</span> <span class="keyword">SIZE</span> <span class="number">4096</span>M <span class="keyword">AUTOEXTEND</span> <span class="keyword">ON</span> <span class="keyword">NEXT</span> <span class="number">4096</span>M <span class="keyword">MAXSIZE</span> <span class="keyword">UNLIMITED</span> <span class="keyword">EXTENT</span> <span class="keyword">MANAGEMENT</span> <span class="keyword">LOCAL</span> <span class="keyword">SEGMENT</span> <span class="keyword">SPACE</span> <span class="keyword">MANAGEMENT</span> <span class="keyword">AUTO</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLESPACE</span> TBS_FBEXCHANGE2 <span class="keyword">LOGGING</span> <span class="keyword">DATAFILE</span> <span class="string">'/u02/sjqh/TBS_FBEXCHANGE2.dbf'</span> <span class="keyword">SIZE</span> <span class="number">4096</span>M <span class="keyword">AUTOEXTEND</span> <span class="keyword">ON</span> <span class="keyword">NEXT</span> <span class="number">4096</span>M <span class="keyword">MAXSIZE</span> <span class="keyword">UNLIMITED</span> <span class="keyword">EXTENT</span> <span class="keyword">MANAGEMENT</span> <span class="keyword">LOCAL</span> <span class="keyword">SEGMENT</span> <span class="keyword">SPACE</span> <span class="keyword">MANAGEMENT</span> <span class="keyword">AUTO</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLESPACE</span> TBS_STKADMIN <span class="keyword">LOGGING</span> <span class="keyword">DATAFILE</span> <span class="string">'/u02/sjqh/TBS_STKADMIN.dbf'</span> <span class="keyword">SIZE</span> <span class="number">4096</span>M <span class="keyword">AUTOEXTEND</span> <span class="keyword">ON</span> <span class="keyword">NEXT</span> <span class="number">4096</span>M <span class="keyword">MAXSIZE</span> <span class="keyword">UNLIMITED</span> <span class="keyword">EXTENT</span> <span class="keyword">MANAGEMENT</span> <span class="keyword">LOCAL</span> <span class="keyword">SEGMENT</span> <span class="keyword">SPACE</span> <span class="keyword">MANAGEMENT</span> <span class="keyword">AUTO</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLESPACE</span> TBS_RISK <span class="keyword">LOGGING</span> <span class="keyword">DATAFILE</span> <span class="string">'/u02/sjqh/TBS_RISK.dbf'</span> <span class="keyword">SIZE</span> <span class="number">4096</span>M <span class="keyword">AUTOEXTEND</span> <span class="keyword">ON</span> <span class="keyword">NEXT</span> <span class="number">4096</span>M <span class="keyword">MAXSIZE</span> <span class="keyword">UNLIMITED</span> <span class="keyword">EXTENT</span> <span class="keyword">MANAGEMENT</span> <span class="keyword">LOCAL</span> <span class="keyword">SEGMENT</span> <span class="keyword">SPACE</span> <span class="keyword">MANAGEMENT</span> <span class="keyword">AUTO</span>;</span><br><span class="line"><span class="keyword">CREATE</span> <span class="keyword">TABLESPACE</span> TBS_MIGRATE <span class="keyword">LOGGING</span> <span class="keyword">DATAFILE</span> <span class="string">'/u02/sjqh/TBS_MIGRATE.dbf'</span> <span class="keyword">SIZE</span> <span class="number">4096</span>M <span class="keyword">AUTOEXTEND</span> <span class="keyword">ON</span> <span class="keyword">NEXT</span> <span class="number">4096</span>M <span class="keyword">MAXSIZE</span> <span class="keyword">UNLIMITED</span> <span class="keyword">EXTENT</span> <span class="keyword">MANAGEMENT</span> <span class="keyword">LOCAL</span> <span class="keyword">SEGMENT</span> <span class="keyword">SPACE</span> <span class="keyword">MANAGEMENT</span> <span class="keyword">AUTO</span>;</span><br><span class="line"><span class="keyword">commit</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>上传备份文件到 <code>/u02/dumpdp</code> 并 解压, 修改 SID</p>
</li>
<li><p>上传 <code>asptools</code> 到 <code>/home/oracle</code> 解压</p>
</li>
<li><p>修改 <code>asptools/globalcfg/para.cfg</code> 中 SID</p>
</li>
<li><p>进入 <code>asptools/dataPumpTools/backupDBTools_full/shell</code></p>
</li>
<li><p>创建 <code>dumpdir</code></p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">sqlplus / as sysdba</span><br><span class="line"></span><br><span class="line"><span class="comment">-- 创建 dumpdir</span></span><br><span class="line"><span class="keyword">create</span> <span class="keyword">or</span> <span class="keyword">replace</span> <span class="keyword">directory</span> dumpdir <span class="keyword">as</span> <span class="string">'/u02/dumpdp'</span>;</span><br></pre></td></tr></table></figure>
</li>
<li><p>执行 <code>./restore.sh 日期</code> (<code>./restore.sh 20200214</code>)</p>
</li>
<li><p>等待恢复完成</p>
</li>
<li><p>PLSQL 使用 sys 用户执行</p>
<figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">grant</span> <span class="keyword">execute</span> <span class="keyword">on</span> DBMS_LOCK <span class="keyword">to</span> settleadmin;</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">execute</span> <span class="keyword">on</span> DBMS_LOCK <span class="keyword">to</span> fbexchange2;</span><br><span class="line"><span class="keyword">grant</span> <span class="keyword">drop</span> <span class="keyword">any</span> <span class="keyword">table</span> <span class="keyword">to</span> settleadmin;</span><br></pre></td></tr></table></figure>
</li>
<li><p>分别 使用 <code>settleadmin</code> 和 <code>fbexchange2</code> 用户登录 PLSQL 编译无效对象</p>
</li>
</ol>
<h3 id="柜台搭建"><a href="#柜台搭建" class="headerlink" title="柜台搭建"></a>柜台搭建</h3><blockquote>
<p><strong><em>root 用户</em></strong></p>
</blockquote>
<ol>
<li><p>上传 <code>tomcat.tar.gz</code> 到 <code>/home</code>, 解压</p>
</li>
<li><p>配置环境变量</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">cat &gt; /root/.bash_profile &lt;&lt;"EOF"</span><br><span class="line">if [ -f ~/.bashrc ]; then</span><br><span class="line">. ~/.bashrc</span><br><span class="line">fi</span><br><span class="line">export JAVA_HOME=/home/tomcat/jdk1.7.0_60</span><br><span class="line">export PATH=$JAVA_HOME/bin:$PATH:$HOME/bin</span><br><span class="line">export LANG=zh_CN.GBK</span><br><span class="line">unset USERNAME</span><br><span class="line">EOF</span><br><span class="line">. /root/.bash_profile</span><br></pre></td></tr></table></figure>
</li>
<li><p>修改 <code>/home/tomcat/apache-tomcat-6.0.43/conf/Catalina/localhost/java.xml</code> 中 数据库配置</p>
</li>
<li><p>启动柜台 <code>cd /home/tomcat/apache-tomcat-6.0.43/bin/ &amp;&amp; ./startup.sh</code></p>
</li>
</ol>
<h2 id="交易系统部署"><a href="#交易系统部署" class="headerlink" title="交易系统部署"></a>交易系统部署</h2><h3 id="组件部署"><a href="#组件部署" class="headerlink" title="组件部署"></a>组件部署</h3><ol>
<li><p>创建用户 (<code>每台机器</code>)</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">groupadd app</span><br><span class="line">useradd -g app trade</span><br><span class="line">echo 'trade:trade' | chpasswd</span><br><span class="line">useradd -g app risk</span><br><span class="line">echo 'risk:risk' | chpasswd</span><br><span class="line">chown -R trade:app /home/trade</span><br><span class="line">chmod -R 755 /home/trade</span><br><span class="line">chown -R risk:app /home/risk</span><br><span class="line">chmod -R 755 /home/risk</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置 <code>/etc/hosts</code> (<code>config 机</code>)</p>
<blockquote>
<p>添加 <code>附录2</code> 中的记录</p>
</blockquote>
</li>
<li><p>建立信任关系 (config 机)</p>
<blockquote>
<p><strong>每步执行</strong>, 不能全部复制执行!!</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">su - trade</span><br><span class="line">ssh-keygen -t rsa</span><br><span class="line">ssh-copy-id db</span><br><span class="line">ssh-copy-id config</span><br><span class="line">ssh-copy-id trade1</span><br><span class="line">ssh-copy-id trade2</span><br><span class="line">exit</span><br><span class="line"></span><br><span class="line">su - risk</span><br><span class="line">ssh-keygen -t rsa</span><br><span class="line">ssh-copy-id db</span><br><span class="line">ssh-copy-id config</span><br><span class="line">ssh-copy-id trade1</span><br><span class="line">ssh-copy-id trade2</span><br><span class="line">exit</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置 <code>trade</code> 用户的 <code>.bash_profile</code></p>
<blockquote>
<p><code>config</code>, <code>db</code> 机</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br></pre></td><td class="code"><pre><span class="line">cat &gt; .bash_profile &lt;&lt;"EOF"</span><br><span class="line">if [ -f ~/.bashrc ]; then</span><br><span class="line">        . ~/.bashrc</span><br><span class="line">fi</span><br><span class="line"></span><br><span class="line">export LANG=zh_CN.GBK</span><br><span class="line">export NLS_LANG="SIMPLIFIED CHINESE_CHINA.ZHS16GBK"</span><br><span class="line"></span><br><span class="line">export APP_HOME=/home/trade</span><br><span class="line">PATH=$PATH:$HOME/shell:$HOME/asptools:./</span><br><span class="line">export PATH=$PATH:~/tools/instantclient_11_1:.</span><br><span class="line">export LD_LIBRARY_PATH=~/tools/instantclient_11_1:./</span><br><span class="line">export TNS_ADMIN=~/tools/instantclient_11_1</span><br><span class="line">export OCI_PATH=~/tools/instantclient_11_1</span><br><span class="line"></span><br><span class="line">set -o vi</span><br><span class="line"></span><br><span class="line">alias sa="ssh-agent /bin/sh"</span><br><span class="line">alias ll="ls -l"</span><br><span class="line"></span><br><span class="line">unset USERNAME</span><br><span class="line">EOF</span><br><span class="line">. .bash_profile</span><br></pre></td></tr></table></figure>

<blockquote>
<p><code>trade1</code>, <code>trade2</code> 机</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">cat &gt; .bash_profile &lt;&lt;"EOF"</span><br><span class="line">if [ -f ~/.bashrc ]; then</span><br><span class="line">        . ~/.bashrc</span><br><span class="line">fi</span><br><span class="line">PATH=$PATH:$HOME/bin:.</span><br><span class="line">export NLS_LANG="SIMPLIFIED CHINESE_CHINA.ZHS16GBK"</span><br><span class="line">export PATH=$PATH:~/tools/instantclient_11_1:.</span><br><span class="line">export LD_LIBRARY_PATH=~/tools/instantclient_11_1:./</span><br><span class="line">export TNS_ADMIN=~/tools/instantclient_11_1</span><br><span class="line">export OCI_PATH=~/tools/instantclient_11_1</span><br><span class="line">EOF</span><br><span class="line">. .bash_profile</span><br></pre></td></tr></table></figure>
</li>
<li><p>上传文件到 <code>config</code> 机 <code>/home/trade</code> 目录</p>
<ul>
<li><code>cfg.tar.gz</code></li>
<li><code>instantclient_11_1.tar.gz</code></li>
<li><code>shell.tar.gz</code></li>
<li><code>cpfront</code></li>
</ul>
</li>
<li><p>解压上传的文件</p>
</li>
<li><p>创建目录, 整理目录</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">mkdir tools</span><br><span class="line">mv instantclient_11_1 tools</span><br><span class="line"></span><br><span class="line">rm -rf *.gz</span><br></pre></td></tr></table></figure>

<p>整理后目录结构 如下:</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">|-- cpfront</span><br><span class="line">|-- cfg</span><br><span class="line">|-- shell</span><br><span class="line">`-- tools</span><br><span class="line">    `-- instantclient_11_1</span><br></pre></td></tr></table></figure>
</li>
<li><p>检查组件版本, 如果不对, 自行修改 <code>sh.cfg</code> 为 <code>run</code> 下文件夹名称</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">ls cfg/run</span><br><span class="line">cat shell/sh.cfg|grep CurrentVersion</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置 <code>tnsnames.ora</code> 中 数据库 <code>地址</code> 和 <code>SID</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd tools/instantclient_11_1/</span><br><span class="line">mv tnsnames.ora_simple tnsnames.ora</span><br><span class="line">vi tnsnames.ora</span><br></pre></td></tr></table></figure>
</li>
<li><p>根据 <code>附录3</code> 修改 <code>shell/list</code></p>
</li>
<li><p>根据 <code>附录4</code> 配置 <code>cfg/config/DeployConfig.xml</code></p>
<ul>
<li>Topics<ul>
<li>均配置 <code>B1.1</code>, <code>B1.2</code> 的 255 (<code>172.17.1.255</code>, <code>172.17.2.255</code>)</li>
</ul>
</li>
<li>Services<ul>
<li>arb : <code>config</code> 的 <code>B2</code></li>
<li>tquery : <code>trade1</code> 的 <code>B1.1</code>, <code>trade2</code> 的 <code>B1.2</code></li>
<li>frontftd : <code>0.0.0.0</code></li>
<li>mdftd : <code>0.0.0.0</code></li>
<li>tinit : <code>config</code> 的 <code>B1.3</code></li>
<li>hotline : <code>trade1</code>, <code>trade2</code> 的 <code>B2</code></li>
<li>ochannel : <code>trade1</code>, <code>trade2</code> 的 <code>B7</code></li>
<li>bchannel : <code>trade1</code>, <code>trade2</code> 的 <code>B7</code></li>
<li>cfmmchannel : <code>trade1</code> 的 <code>B7</code></li>
<li>ptopmd : <code>0.0.0.0</code></li>
</ul>
</li>
<li>Databases<ul>
<li>修改 <code>connectString</code> 为 数据库 <code>SID</code></li>
</ul>
</li>
</ul>
</li>
<li><p>复制 <code>DeployConfig.xml</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cp DeployConfig.xml DeployConfig.dbmt_se.xml</span><br><span class="line">cp DeployConfig.xml DeployConfig.tkernel1.xml</span><br><span class="line">cp DeployConfig.xml DeployConfig.tkernel2.xml</span><br></pre></td></tr></table></figure>

<ul>
<li>修改 <code>DeployConfig.dbmt_se.xml</code><ul>
<li><code>frontftd</code> 修改为 <code>trade1</code>, <code>trade2</code> 的 <code>B1.3</code></li>
</ul>
</li>
<li>修改 <code>DeployConfig.tkernel1.xml</code><ul>
<li>删除 <code>tresult</code> 的 <code>B1.2</code> 网段</li>
</ul>
</li>
<li>修改 <code>DeployConfig.tkernel2.xml</code><ul>
<li>删除 <code>tresult</code> 的 <code>B1.1</code> 网段</li>
</ul>
</li>
</ul>
</li>
<li><p>修改 kernel 组件 配置</p>
<ul>
<li>进入 组件包 目录 <code>/home/trade/cfg/run/6.3.17_P6_20190920</code></li>
<li><code>vi tkernel/tkernel.ini</code></li>
<li><code>vi qkernel/qkernel.ini</code></li>
<li><code>vi okernel/okernel.ini</code></li>
<li>修改 <code>MemorySize=2048</code></li>
</ul>
</li>
<li><p>分发组件 及 其他配置</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> -- 分发组件 --</span></span><br><span class="line"></span><br><span class="line">ecall.sh makebasepath</span><br><span class="line">cpiniall.sh</span><br><span class="line">cpall.sh</span><br><span class="line">cpobjall.sh</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> -- cpfront 配置报盘前置 --</span></span><br><span class="line"></span><br><span class="line">cat &gt; cpfront &lt;&lt;EOF</span><br><span class="line">ssh front_se11  cp front_se11/bin/front_md_se front_se11/bin/front_se</span><br><span class="line">ssh front_se12  cp front_se12/bin/front_md_se front_se12/bin/front_se</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">chmod +x cpfront</span><br><span class="line">./cpfront</span><br></pre></td></tr></table></figure>

<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line"><span class="meta">#</span><span class="bash"> -- perf 和 unldr 冒烟组件配置 --</span></span><br><span class="line"></span><br><span class="line">ssh tinit</span><br><span class="line">cd tinit</span><br><span class="line">mkdir perf</span><br></pre></td></tr></table></figure>

<p>上传 <code>unldr</code> 到 <code>tinit</code> 组件下, 解压, 修改 <code>exportSync.sh</code> 的 <code>SID</code></p>
</li>
</ol>
<h3 id="冒烟测试"><a href="#冒烟测试" class="headerlink" title="冒烟测试"></a>冒烟测试</h3><blockquote>
<p><code>config</code> 机 <code>trade</code> 用户</p>
</blockquote>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">cd</span><br><span class="line">cat &gt; shell/list.my &lt;&lt;EOF</span><br><span class="line">arb</span><br><span class="line">compositor 1</span><br><span class="line">compositor 2</span><br><span class="line">tkernel 1</span><br><span class="line">tkernel 2</span><br><span class="line">qkernel 1</span><br><span class="line">qkernel 2</span><br><span class="line">okernel 1</span><br><span class="line">offermanager 1</span><br><span class="line">offermanager 2</span><br><span class="line">front_se 1</span><br><span class="line">front_se 2</span><br><span class="line">front_se 11</span><br><span class="line">front_se 12</span><br><span class="line">tinit csv</span><br><span class="line">EOF</span><br><span class="line"></span><br><span class="line">cp shell/list shell/list.hf</span><br></pre></td></tr></table></figure>

<p>上传 冒烟脚本 <code>sjqhtools</code> 到 <code>/home/trade</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br></pre></td><td class="code"><pre><span class="line">cd ~/sjqhtools</span><br><span class="line">chmod +x *</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash"> 开始冒烟测试</span></span><br><span class="line"></span><br><span class="line">./marketcheck.sh</span><br><span class="line"><span class="meta">#</span><span class="bash"> 确认输出 是下个交易日</span></span><br><span class="line">./maoyan.sh</span><br><span class="line"><span class="meta">#</span><span class="bash"> 确认 为 15个进程</span></span><br><span class="line">startall.sh</span><br><span class="line"><span class="meta">#</span><span class="bash"> 2000 输入密码 确认15个进程存活</span></span><br></pre></td></tr></table></figure>

<p>windows 机器 使用 <code>ticlient</code> 初始化</p>
<p>IP <code>172.0.0.14</code> (<code>tinit</code> 组件 <code>b1.3</code> 网段地址) 端口 <code>41315</code> 和 <code>DeployConfig.xml</code> 一致</p>
<ol>
<li>登录(空密码登录)</li>
<li>状态查询(确认为下一交易日)</li>
<li>日初数据同步</li>
<li>显示两个 <code>操作成功</code></li>
</ol>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">showall.sh</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看 进程全部为 运行状态</span></span><br><span class="line">./dumpcheck.sh</span><br><span class="line"><span class="meta">#</span><span class="bash"> 错误为 0</span></span><br><span class="line">11stop.sh</span><br><span class="line">./aftermaoyan.sh</span><br><span class="line"><span class="meta">#</span><span class="bash"> 查看为 42 个进程</span></span><br></pre></td></tr></table></figure>

<h2 id="风控系统部署"><a href="#风控系统部署" class="headerlink" title="风控系统部署"></a>风控系统部署</h2><p><code>TODO</code></p>
<h2 id="结算-开户工具部署"><a href="#结算-开户工具部署" class="headerlink" title="结算,开户工具部署"></a>结算,开户工具部署</h2><h3 id="准备工作-均在-trade-用户"><a href="#准备工作-均在-trade-用户" class="headerlink" title="准备工作 (均在 trade 用户)"></a>准备工作 (均在 trade 用户)</h3><blockquote>
<p><code>db</code> 机</p>
</blockquote>
<ol>
<li><p>确认 <code>数据库</code>, <code>柜台</code>, <code>交易组件</code> 部署完成</p>
</li>
<li><p>确认 <code>数据库</code> 开启, <code>数据库监听</code> 开启 , <code>柜台</code> 开启</p>
</li>
</ol>
<blockquote>
<p>所有机器</p>
</blockquote>
<ol>
<li><p>创建文件夹</p>
<figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">cd</span><br><span class="line">mkdir data</span><br><span class="line">mkdir data&#x2F;settlementfile</span><br><span class="line">mkdir data&#x2F;settlementbill</span><br><span class="line">mkdir data&#x2F;fundsettlementfile</span><br><span class="line">mkdir data&#x2F;csrc</span><br><span class="line">mkdir -p tools&#x2F;settlement_tools&#x2F;</span><br></pre></td></tr></table></figure>

</li>
</ol>
<blockquote>
<p><code>config</code> 机</p>
</blockquote>
<ol>
<li><p>上传 <code>instantclient_11_1.tar.gz</code> 到 <code>~/tools</code> 解压, 配置</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd ~/tools</span><br><span class="line">tar zxf instantclient_11_1.tar.gz</span><br><span class="line">rm -rf instantclient_11_1.tar.gz</span><br><span class="line">cd instantclient_11_1</span><br><span class="line">cp tnsnames.ora_simple tnsnames.ora</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置数据库连接地址 为 <code>db</code> 的 <code>B1.3 管理网</code> (172.0.0.10), 配置 <code>SID</code> (sjqh1)</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi tnsnames.ora</span><br></pre></td></tr></table></figure>
</li>
<li><p>上传 <code>common</code>, <code>python</code> 到 <code>~/tools/settlement_tools</code></p>
<p><code>python</code> 添加执行权限 , 配置 <code>python</code> 数据库连接</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd</span><br><span class="line">chmod a+x ~/tools/settlement_tools/python/bin/*</span><br><span class="line">vi tools/settlement_tools/common/connman/connman.cfg</span><br></pre></td></tr></table></figure>
</li>
<li><p>复制配置到其他机器</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><span class="line">cd</span><br><span class="line"></span><br><span class="line">scp -r tools/* db:/home/trade/tools</span><br><span class="line">scp -r tools/* trade1:/home/trade/tools</span><br><span class="line">scp -r tools/* trade2:/home/trade/tools</span><br><span class="line"></span><br><span class="line">scp -r shell db:/home/trade</span><br><span class="line">scp -r shell trade1:/home/trade</span><br><span class="line">scp -r shell trade2:/home/trade</span><br></pre></td></tr></table></figure>

</li>
</ol>
<h3 id="upload-工具-部署"><a href="#upload-工具-部署" class="headerlink" title="upload 工具 部署"></a><code>upload</code> 工具 部署</h3><blockquote>
<p><code>db</code>机 <code>trade</code> 用户</p>
</blockquote>
<ol>
<li><p>上传 <code>upload</code> 组件到 <code>~/tools/settlement_tools</code></p>
</li>
<li><p>转换 dos, 添加权限</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">cd ~/tools/settlement_tools/upload</span><br><span class="line">dos2unix *.sh *.ctl *.ini</span><br><span class="line">chmod a+x *.sh</span><br><span class="line">chmod a+x upload</span><br><span class="line">chmod a+x loader</span><br><span class="line">chmod a+x dbfImport</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置文件</p>
<p>修改数据库 <code>SID</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi ~/tools/settlement_tools/upload/upload.sh</span><br></pre></td></tr></table></figure>

<p>配置定时任务, 添加 <code>*/1 * * * * cd /home/trade/tools/settlement_tools/upload &amp;&amp; ./upload.sh &gt;log/cron.log 2&gt;&amp;1</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crontab -e</span><br></pre></td></tr></table></figure>
</li>
<li><p>运行 <code>cd ~/tools/settlement_tools/upload &amp;&amp; ./upload.sh</code></p>
<p><code>cat log/*</code> 中 有 <code>连接数据库：settleadmin/******@sjqh1成功。</code>, 即 配置成功</p>
</li>
</ol>
<h3 id="backup-sett-data-工具-部署"><a href="#backup-sett-data-工具-部署" class="headerlink" title="backup_sett_data 工具 部署"></a><code>backup_sett_data</code> 工具 部署</h3><blockquote>
<p><code>db</code> 机 <code>trade</code> 用户</p>
</blockquote>
<ol>
<li><p>上传 <code>backup_sett_data</code> 组件到 <code>~/tools/settlement_tools</code></p>
</li>
<li><p>转换 dos, 添加权限</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd ~/tools/settlement_tools/backup_sett_data</span><br><span class="line">dos2unix *.sh *.py *.template</span><br><span class="line">chmod a+x *.sh</span><br><span class="line">chmod a+x sqlunldr</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置文件</p>
<p>根据实际情况配置 (本指南默认不修改)</p>
<p>如需 修改, 请保证 <code>database</code> 的 key 与 <code>tools/settlement_tools/common/connman/connman.cfg</code> 中 <code>connections</code> 的 key 对应</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi ~/tools/settlement_tools/backup_sett_data/config.cfg</span><br></pre></td></tr></table></figure>
</li>
<li><p>运行 <code>cd ~/tools/settlement_tools/backup_sett_data &amp;&amp; ./run.sh &amp;&amp; ps -ef | grep main.py | grep -v grep</code></p>
<p>显示 有进程 <code>python main.py</code> 即 配置成功</p>
</li>
</ol>
<h3 id="mainapi-工具-部署"><a href="#mainapi-工具-部署" class="headerlink" title="mainapi 工具 部署"></a><code>mainapi</code> 工具 部署</h3><blockquote>
<p><code>trade1</code>机 <code>trade</code>用户</p>
</blockquote>
<ol>
<li><p>上传 <code>mainapi</code> 组件到 <code>~/</code> (<code>startmainapi.sh</code>, <code>cfmmc_api_20200220.tar.gz</code> 两个文件)</p>
</li>
<li><p>转换 dos, 添加权限, 执行脚本</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><span class="line">cd </span><br><span class="line">chmod a+x startmainapi.sh</span><br><span class="line">tar zxf cfmmc_api_20200220.tar.gz</span><br><span class="line">rm -rf cfmmc_api_20200220.tar.gz</span><br><span class="line">cd ~/cfmmc_api</span><br><span class="line">dos2unix *.dtd *.ini</span><br><span class="line">chmod a+x *.sh</span><br><span class="line">chmod a+x mainapi</span><br><span class="line"></span><br><span class="line">./ln.sh</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置文件 <code>main.ini</code>,修改 <code>监控中心地址</code> 和 <code>数据库SID</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi main.ini</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置文件 <code>startmainapi.sh</code>, 修改 <code>经纪公司ID</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><span class="line">cd</span><br><span class="line">vi startmainapi.sh</span><br></pre></td></tr></table></figure>
</li>
<li><p>运行 <code>cd &amp;&amp; ./startmainapi.sh</code></p>
<p>运行 <code>cat cfmmc_api/nohup.out</code></p>
<p>查看 有 <code>CFMMC Client Api</code> 输出则成功</p>
<p>如提示 <code>cannot open shared object file</code> 则</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">su - root</span><br><span class="line"></span><br><span class="line">cp /usr/lib64/libcurl.so.4 /usr/lib64/libcurl.so.3</span><br><span class="line"></span><br><span class="line">exit</span><br></pre></td></tr></table></figure>

<p>然后再次运行 <code>./startmainapi.sh</code></p>
</li>
</ol>
<h3 id="genfile-工具-部署"><a href="#genfile-工具-部署" class="headerlink" title="genfile 工具 部署"></a><code>genfile</code> 工具 部署</h3><blockquote>
<p><code>config</code> 机 <code>trade</code> 用户</p>
</blockquote>
<ol>
<li><p>上传 <code>genfile</code> 组件到 <code>~/tools/settlement_tools</code></p>
</li>
<li><p><code>ssh websrv</code> 查看是否连通, 否则在 <code>/etc/hosts</code> 中添加 <code>172.0.0.10 websrv</code> 即 <code>web</code> 的地址</p>
</li>
<li><p>转换 dos, 添加权限</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><span class="line">cd ~/tools/settlement_tools/genfile</span><br><span class="line">dos2unix *.sh *.ctl *.ini</span><br><span class="line">chmod a+x *.sh</span><br><span class="line">chmod a+x genfile</span><br><span class="line">chmod a+x sqlunldr</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置文件</p>
<p>修改数据库 <code>SID</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi ~/tools/settlement_tools/genfile/genfile.sh</span><br></pre></td></tr></table></figure>

<p>配置定时任务, 添加 <code>*/1 * * * * cd /home/trade/tools/settlement_tools/genfile &amp;&amp; ./genfile.sh &gt;log/cron.log 2&gt;&amp;1</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crontab -e</span><br></pre></td></tr></table></figure>
</li>
<li><p>运行 <code>cd ~/tools/settlement_tools/genfile &amp;&amp; ./genfile.sh</code></p>
<p><code>cat log/*</code> 中 有 <code>连接数据库成功</code>, 即 配置成功</p>
</li>
</ol>
<h3 id="gencffexfile-工具-部署"><a href="#gencffexfile-工具-部署" class="headerlink" title="gencffexfile 工具 部署"></a><code>gencffexfile</code> 工具 部署</h3><blockquote>
<p><code>config</code>机 <code>trade</code>用户</p>
</blockquote>
<ol>
<li><p>上传 <code>gencffexfile</code> 组件到 <code>~/tools/settlement_tools</code></p>
</li>
<li><p><code>ssh websrv</code> 查看是否连通, 否则在 <code>/etc/hosts</code> 中添加 <code>172.0.0.10 websrv</code> 即 <code>web</code> 的地址</p>
</li>
<li><p>转换 dos, 添加权限</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">cd ~/tools/settlement_tools/gencffexfile</span><br><span class="line">dos2unix *.sh *.ini</span><br><span class="line">chmod a+x *.sh</span><br><span class="line">chmod a+x gencffexfile</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置文件</p>
<p>修改 <code>数据库SID</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi gencffexfile.sh</span><br></pre></td></tr></table></figure>

<p>配置定时任务, 添加 <code>*/1 * * * *  cd /home/trade/tools/settlement_tools/gencffexfile &amp;&amp; ./gencffexfile.sh &gt;log/cron.log 2&gt;&amp;1</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">crontab -e</span><br></pre></td></tr></table></figure>
</li>
<li><p>运行 <code>cd ~/tools/settlement_tools/gencffexfile &amp;&amp; ./gencffexfile.sh</code></p>
<p><code>cat log/gencffexfile.log</code> 有 <code>连接数据库成功</code>,  即 配置成功 </p>
</li>
</ol>
<h3 id="genclientfile-工具-部署"><a href="#genclientfile-工具-部署" class="headerlink" title="genclientfile 工具 部署"></a><code>genclientfile</code> 工具 部署</h3><blockquote>
<p><code>config</code> 机 <code>trade</code> 用户</p>
</blockquote>
<ol>
<li><p>上传 <code>genclientfile</code> 组件到 <code>~/tools/settlement_tools</code></p>
</li>
<li><p>转换 dos, 添加权限</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line">cd ~/tools/settlement_tools/genclientfile</span><br><span class="line">dos2unix *.sh *.py *.cfg</span><br><span class="line">chmod a+x *.sh</span><br></pre></td></tr></table></figure>
</li>
<li><p>复制组件到其他机器, 以及创建目录</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">scp -r ~/tools/settlement_tools/genclientfile/ db:/home/trade/tools/settlement_tools</span><br><span class="line">scp -r ~/tools/settlement_tools/genclientfile/ trade1:/home/trade/tools/settlement_tools</span><br><span class="line">scp -r ~/tools/settlement_tools/genclientfile/ trade2:/home/trade/tools/settlement_tools</span><br><span class="line"></span><br><span class="line">ssh trade1 "mkdir -p /home/trade/qkernel1/bin/SettlementInfo"</span><br><span class="line">ssh trade2 "mkdir -p /home/trade/qkernel2/bin/SettlementInfo"</span><br></pre></td></tr></table></figure>
</li>
<li><p>配置文件</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">cd ~/tools/settlement_tools/genclientfile/</span><br></pre></td></tr></table></figure>

<p><code>config</code> 机</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi genclient.cfg</span><br></pre></td></tr></table></figure>

<p>参考配置</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br></pre></td><td class="code"><pre><span class="line">[general]</span><br><span class="line">debug = true</span><br><span class="line">interval = 30</span><br><span class="line"></span><br><span class="line">[database]</span><br><span class="line">connect_name = aspctp2_settleadmin</span><br><span class="line"></span><br><span class="line">[qkernel]</span><br><span class="line">server=http://qkernel1:9000, http://qkernel2:9000</span><br><span class="line"></span><br><span class="line">[webserver]</span><br><span class="line">server=http://web1:9001</span><br></pre></td></tr></table></figure>

<p><code>db</code>, <code>trade1</code>, <code>trade2</code> 机</p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><span class="line">vi server.cfg</span><br></pre></td></tr></table></figure>

<p>参考配置 <code>db</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[general]</span><br><span class="line">debug = true</span><br><span class="line">upload_path = ./temp</span><br><span class="line">dest_path = ./dest</span><br><span class="line"></span><br><span class="line">[server]</span><br><span class="line">listen_port = 9001</span><br></pre></td></tr></table></figure>

<p>参考配置 <code>trade1</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[general]</span><br><span class="line">debug = true</span><br><span class="line">upload_path = ./temp</span><br><span class="line">dest_path = /home/trade/qkernel1/bin/SettlementInfo</span><br><span class="line"></span><br><span class="line">[server]</span><br><span class="line">listen_port = 9000</span><br></pre></td></tr></table></figure>

<p>参考配置 <code>trade2</code></p>
<figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><span class="line">[general]</span><br><span class="line">debug = true</span><br><span class="line">upload_path = ./temp</span><br><span class="line">dest_path = /home/trade/qkernel2/bin/SettlementInfo</span><br><span class="line"></span><br><span class="line">[server]</span><br><span class="line">listen_port = 9000</span><br></pre></td></tr></table></figure>

<blockquote>
<p>注意</p>
</blockquote>
</li>
</ol>
<h1 id="附录"><a href="#附录" class="headerlink" title="附录"></a>附录</h1><h2 id="附录-1-网络-IP-配置"><a href="#附录-1-网络-IP-配置" class="headerlink" title="附录 1: 网络 IP 配置"></a>附录 1: 网络 IP 配置</h2><table>
<thead>
<tr>
<th align="left">机器名</th>
<th align="left">B1.1</th>
<th align="left">B1.2</th>
<th align="left">B1.3 管理</th>
<th align="left">B2 仲裁</th>
<th align="left">B7 报盘</th>
<th align="left">B8 风控</th>
</tr>
</thead>
<tbody><tr>
<td align="left">DB</td>
<td align="left">172.17.1.10</td>
<td align="left">172.17.2.10</td>
<td align="left">172.0.0.10</td>
<td align="left">-</td>
<td align="left">-</td>
<td align="left">-</td>
</tr>
<tr>
<td align="left">trade1</td>
<td align="left">172.17.1.11</td>
<td align="left">172.17.2.11</td>
<td align="left">172.0.0.11</td>
<td align="left">172.17.3.11</td>
<td align="left">172.17.5.11</td>
<td align="left">172.17.7.11</td>
</tr>
<tr>
<td align="left">trade2</td>
<td align="left">172.17.1.12</td>
<td align="left">172.17.2.12</td>
<td align="left">172.0.0.12</td>
<td align="left">172.17.3.12</td>
<td align="left">172.17.5.12</td>
<td align="left">172.17.7.12</td>
</tr>
<tr>
<td align="left">arb+config</td>
<td align="left">172.17.1.14</td>
<td align="left">172.17.2.14</td>
<td align="left">172.0.0.14</td>
<td align="left">172.17.3.14</td>
<td align="left">-</td>
<td align="left">172.17.7.14</td>
</tr>
</tbody></table>
<h2 id="附录-2-etc-hosts-配置"><a href="#附录-2-etc-hosts-配置" class="headerlink" title="附录 2: /etc/hosts 配置"></a>附录 2: <code>/etc/hosts</code> 配置</h2><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><span class="line">172.0.0.10 db web</span><br><span class="line">172.0.0.11 trade1</span><br><span class="line">172.0.0.12 trade2</span><br><span class="line">172.0.0.14 config</span><br><span class="line"></span><br><span class="line">172.0.0.10 web1 websrv ftpsrv</span><br><span class="line"></span><br><span class="line">172.0.0.11 front_se1 front_se11</span><br><span class="line">172.0.0.12 front_se2 front_se12</span><br><span class="line">172.0.0.11 compositor1 tkernel1 qkernel1 okernel1</span><br><span class="line">172.0.0.12 compositor2 tkernel2 qkernel2</span><br><span class="line">172.0.0.11 offermanager1 shfeoffer1 shfemdserver1 cffexoffer1 ffexmdserver1 ineoffer1 inemdserver1 dceoffer1 dcemdserver1 zceoffer1 zcemdserver1</span><br><span class="line">172.0.0.12 offermanager2 shfeoffer2 shfemdserver2 cffexoffer2 ffexmdserver2 ineoffer2 inemdserver2 dceoffer2 dcemdserver2 zceoffer2 zcemdserver2</span><br><span class="line">172.0.0.11 cfmmcoffer1 cfmmcoffermanager1 mainapi sendfile bankmanager1</span><br><span class="line">172.0.0.12 bankmanager2</span><br><span class="line"></span><br><span class="line">172.0.0.14 tinit tmdb dbmt_se drmt sync_merge</span><br><span class="line">172.0.0.14 arb genclientfile genfile</span><br><span class="line">172.0.0.14 riskarb riskengine1 riskgate1 riskcompositor1 riskfront1 riskdbwriter riskdrmt1 oprdispatcher</span><br></pre></td></tr></table></figure>

<h2 id="附录-3-list-配置"><a href="#附录-3-list-配置" class="headerlink" title="附录 3: list 配置"></a>附录 3: <code>list</code> 配置</h2><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br></pre></td><td class="code"><pre><span class="line">arb</span><br><span class="line">compositor 1</span><br><span class="line">compositor 2</span><br><span class="line">tkernel 1</span><br><span class="line">tkernel 2</span><br><span class="line">qkernel 1</span><br><span class="line">qkernel 2</span><br><span class="line">okernel 1</span><br><span class="line">offermanager 1</span><br><span class="line">offermanager 2</span><br><span class="line">front_se 1</span><br><span class="line">front_se 2</span><br><span class="line">front_se 11</span><br><span class="line">front_se 12</span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">mdfront 1</span></span><br><span class="line"><span class="meta">#</span><span class="bash">mdfront 2</span></span><br><span class="line"></span><br><span class="line"><span class="meta">#</span><span class="bash">tradeagent 1</span></span><br><span class="line"><span class="meta">#</span><span class="bash">tradeagent 2</span></span><br><span class="line"><span class="meta">#</span><span class="bash">tcpagent 1</span></span><br><span class="line"><span class="meta">#</span><span class="bash">tcpagent 2</span></span><br><span class="line"></span><br><span class="line">tinit</span><br><span class="line">dbmt_se</span><br><span class="line">tmdb</span><br><span class="line">drmt</span><br><span class="line"><span class="meta">#</span><span class="bash">tinit csv</span></span><br><span class="line"></span><br><span class="line"></span><br><span class="line">cfmmcoffermanager 1</span><br><span class="line">cfmmcoffer 1 1 1</span><br><span class="line">bankmanager 1</span><br><span class="line"><span class="meta">#</span><span class="bash">cffexotcoffer</span></span><br><span class="line">bankmanager 2</span><br><span class="line"></span><br><span class="line">shfemdserver 1 SHFE 0052 0052c2c 1 1</span><br><span class="line">shfemdserver 2 SHFE 0052 0052c2c 2 2</span><br><span class="line">shfeoffer  1 SHFE 0052 0052c2c 1 1</span><br><span class="line">shfeoffer  2 SHFE 0052 0052c11c 1 2</span><br><span class="line"></span><br><span class="line">ffexmdserver 1 CFFEX 0310 031001 1 1</span><br><span class="line">ffexmdserver 2 CFFEX 0310 031001 2 2</span><br><span class="line">cffexoffer 1 CFFEX 0310 031001 1 1</span><br><span class="line">cffexoffer 2 CFFEX 0310 031005 1 2</span><br><span class="line"></span><br><span class="line">dcemdserver 1 DCE 0207 02072005 1 1</span><br><span class="line">dcemdserver 2 DCE 0207 02072005 2 2</span><br><span class="line">dceoffer 1 DCE 0207 02072005 1 1</span><br><span class="line">dceoffer 2 DCE 0207 00002207 1 2</span><br><span class="line"></span><br><span class="line">zcemdserver 1 CZCE 0092 00920090 1 1</span><br><span class="line">zcemdserver 2 CZCE 0092 00920090 2 2</span><br><span class="line">zceoffer 1 CZCE 0092 00920090 1 1</span><br><span class="line">zceoffer 2 CZCE 0092 00920050 1 2</span><br><span class="line"></span><br><span class="line">inemdserver 1 INE 8052 8052c03c 1 1</span><br><span class="line">inemdserver 2 INE 8052 8052c03c 2 2</span><br><span class="line">ineoffer 1 INE 8052 8052c03c 1 1</span><br><span class="line">ineoffer 2 INE 8052 8052c05c 1 2</span><br></pre></td></tr></table></figure>

<h2 id="附录-4-DeployConfig-xml"><a href="#附录-4-DeployConfig-xml" class="headerlink" title="附录 4: DeployConfig.xml"></a>附录 4: DeployConfig.xml</h2><figure class="highlight xml"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><span class="line"><span class="tag">&lt;<span class="name">DeployConfig</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Topics</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Topic</span> <span class="attr">name</span>=<span class="string">"tseries"</span> <span class="attr">address</span>=<span class="string">"udp://172.17.1.255:41101"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Topic</span> <span class="attr">name</span>=<span class="string">"tseries"</span> <span class="attr">address</span>=<span class="string">"udp://172.17.2.255:41101"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Topic</span> <span class="attr">name</span>=<span class="string">"tresult"</span> <span class="attr">address</span>=<span class="string">"udp://172.17.1.255:41105"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Topic</span> <span class="attr">name</span>=<span class="string">"tresult"</span> <span class="attr">address</span>=<span class="string">"udp://172.17.2.255:41105"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="tag">&lt;<span class="name">Topic</span> <span class="attr">name</span>=<span class="string">"front"</span> <span class="attr">item</span>=<span class="string">"1"</span> <span class="attr">address</span>=<span class="string">"udp://172.17.1.255:41107"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Topic</span> <span class="attr">name</span>=<span class="string">"front"</span> <span class="attr">item</span>=<span class="string">"1"</span> <span class="attr">address</span>=<span class="string">"udp://172.17.2.255:41107"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Topic</span> <span class="attr">name</span>=<span class="string">"front"</span> <span class="attr">item</span>=<span class="string">"2"</span> <span class="attr">address</span>=<span class="string">"udp://172.17.1.255:41109"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Topic</span> <span class="attr">name</span>=<span class="string">"front"</span> <span class="attr">item</span>=<span class="string">"2"</span> <span class="attr">address</span>=<span class="string">"udp://172.17.2.255:41109"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="tag">&lt;<span class="name">Topic</span> <span class="attr">name</span>=<span class="string">"tinit"</span> <span class="attr">address</span>=<span class="string">"udp://172.17.1.255:41211"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Topic</span> <span class="attr">name</span>=<span class="string">"tinit"</span> <span class="attr">address</span>=<span class="string">"udp://172.17.2.255:41211"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="tag">&lt;<span class="name">Topic</span> <span class="attr">name</span>=<span class="string">"oresult"</span> <span class="attr">item</span>=<span class="string">"1"</span> <span class="attr">address</span>=<span class="string">"udp://172.17.1.255:41213"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Topic</span> <span class="attr">name</span>=<span class="string">"oresult"</span> <span class="attr">item</span>=<span class="string">"1"</span> <span class="attr">address</span>=<span class="string">"udp://172.17.2.255:41213"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Topic</span> <span class="attr">name</span>=<span class="string">"oresult"</span> <span class="attr">item</span>=<span class="string">"2"</span> <span class="attr">address</span>=<span class="string">"udp://172.17.1.255:41215"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Topic</span> <span class="attr">name</span>=<span class="string">"oresult"</span> <span class="attr">item</span>=<span class="string">"2"</span> <span class="attr">address</span>=<span class="string">"udp://172.17.2.255:41215"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="tag">&lt;<span class="name">Topic</span> <span class="attr">name</span>=<span class="string">"mdresult"</span> <span class="attr">item</span>=<span class="string">"1"</span> <span class="attr">address</span>=<span class="string">"udp://172.17.1.255:41217"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Topic</span> <span class="attr">name</span>=<span class="string">"mdresult"</span> <span class="attr">item</span>=<span class="string">"1"</span> <span class="attr">address</span>=<span class="string">"udp://172.17.2.255:41217"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Topic</span> <span class="attr">name</span>=<span class="string">"mdresult"</span> <span class="attr">item</span>=<span class="string">"2"</span> <span class="attr">address</span>=<span class="string">"udp://172.17.1.255:41219"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Topic</span> <span class="attr">name</span>=<span class="string">"mdresult"</span> <span class="attr">item</span>=<span class="string">"2"</span> <span class="attr">address</span>=<span class="string">"udp://172.17.2.255:41219"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="tag">&lt;<span class="name">Topic</span> <span class="attr">name</span>=<span class="string">"bresult"</span> <span class="attr">item</span>=<span class="string">"1"</span> <span class="attr">address</span>=<span class="string">"udp://172.17.1.255:41221"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Topic</span> <span class="attr">name</span>=<span class="string">"bresult"</span> <span class="attr">item</span>=<span class="string">"1"</span> <span class="attr">address</span>=<span class="string">"udp://172.17.2.255:41221"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Topic</span> <span class="attr">name</span>=<span class="string">"bresult"</span> <span class="attr">item</span>=<span class="string">"2"</span> <span class="attr">address</span>=<span class="string">"udp://172.17.1.255:41227"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Topic</span> <span class="attr">name</span>=<span class="string">"bresult"</span> <span class="attr">item</span>=<span class="string">"2"</span> <span class="attr">address</span>=<span class="string">"udp://172.17.2.255:41227"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="tag">&lt;<span class="name">Topic</span> <span class="attr">name</span>=<span class="string">"conditionalorder"</span> <span class="attr">item</span>=<span class="string">"1"</span> <span class="attr">address</span>=<span class="string">"udp://172.17.1.255:41223"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Topic</span> <span class="attr">name</span>=<span class="string">"conditionalorder"</span> <span class="attr">item</span>=<span class="string">"1"</span> <span class="attr">address</span>=<span class="string">"udp://172.17.2.255:41223"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="tag">&lt;<span class="name">Topic</span> <span class="attr">name</span>=<span class="string">"cfmmcresult"</span> <span class="attr">item</span>=<span class="string">"1"</span> <span class="attr">address</span>=<span class="string">"udp://172.17.1.255:41225"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Topic</span> <span class="attr">name</span>=<span class="string">"cfmmcresult"</span> <span class="attr">item</span>=<span class="string">"1"</span> <span class="attr">address</span>=<span class="string">"udp://172.17.2.255:41225"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="tag">&lt;<span class="name">Topic</span> <span class="attr">name</span>=<span class="string">"triskorder"</span> <span class="attr">address</span>=<span class="string">"udp://172.17.1.255:40050"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Topic</span> <span class="attr">name</span>=<span class="string">"triskorder"</span> <span class="attr">address</span>=<span class="string">"udp://172.17.2.255:40050"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">Topics</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Services</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Service</span> <span class="attr">name</span>=<span class="string">"arb"</span> <span class="attr">address</span>=<span class="string">"tcp://172.17.3.14:41201"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Service</span> <span class="attr">name</span>=<span class="string">"tquery"</span> <span class="attr">item</span>=<span class="string">"1"</span> <span class="attr">address</span>=<span class="string">"tcp://172.17.1.11:41203"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Service</span> <span class="attr">name</span>=<span class="string">"tquery"</span> <span class="attr">item</span>=<span class="string">"2"</span> <span class="attr">address</span>=<span class="string">"tcp://172.17.2.12:41203"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="tag">&lt;<span class="name">Service</span> <span class="attr">name</span>=<span class="string">"frontftd"</span> <span class="attr">item</span>=<span class="string">"1"</span> <span class="attr">address</span>=<span class="string">"tcp://0.0.0.0:41205"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Service</span> <span class="attr">name</span>=<span class="string">"frontftd"</span> <span class="attr">item</span>=<span class="string">"2"</span> <span class="attr">address</span>=<span class="string">"tcp://0.0.0.0:41205"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="tag">&lt;<span class="name">Service</span> <span class="attr">name</span>=<span class="string">"mdftd"</span> <span class="attr">item</span>=<span class="string">"11"</span> <span class="attr">address</span>=<span class="string">"tcp://0.0.0.0:41213"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Service</span> <span class="attr">name</span>=<span class="string">"mdftd"</span> <span class="attr">item</span>=<span class="string">"12"</span> <span class="attr">address</span>=<span class="string">"tcp://0.0.0.0:41213"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">                <span class="tag">&lt;<span class="name">Service</span> <span class="attr">name</span>=<span class="string">"tinit"</span> <span class="attr">address</span>=<span class="string">"tcp://172.0.0.14:41315"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Service</span> <span class="attr">name</span>=<span class="string">"hotline"</span> <span class="attr">item</span>=<span class="string">"1"</span> <span class="attr">address</span>=<span class="string">"tcp://172.17.3.11:41217"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Service</span> <span class="attr">name</span>=<span class="string">"hotline"</span> <span class="attr">item</span>=<span class="string">"2"</span> <span class="attr">address</span>=<span class="string">"tcp://172.17.3.12:41217"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Service</span> <span class="attr">name</span>=<span class="string">"ochannel"</span> <span class="attr">item</span>=<span class="string">"1"</span> <span class="attr">address</span>=<span class="string">"tcp://172.17.5.11:41230"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Service</span> <span class="attr">name</span>=<span class="string">"ochannel"</span> <span class="attr">item</span>=<span class="string">"2"</span> <span class="attr">address</span>=<span class="string">"tcp://172.17.5.12:41230"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Service</span> <span class="attr">name</span>=<span class="string">"bchannel"</span> <span class="attr">item</span>=<span class="string">"1"</span> <span class="attr">address</span>=<span class="string">"tcp://172.17.5.11:41231"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Service</span> <span class="attr">name</span>=<span class="string">"bchannel"</span> <span class="attr">item</span>=<span class="string">"2"</span> <span class="attr">address</span>=<span class="string">"tcp://172.17.5.12:41231"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Service</span> <span class="attr">name</span>=<span class="string">"cfmmcchannel"</span> <span class="attr">item</span>=<span class="string">"1"</span> <span class="attr">address</span>=<span class="string">"tcp://172.17.5.11:41232"</span>/&gt;</span></span><br><span class="line"></span><br><span class="line">        <span class="tag">&lt;<span class="name">Service</span> <span class="attr">name</span>=<span class="string">"ptopmd"</span> <span class="attr">item</span>=<span class="string">"1"</span> <span class="attr">address</span>=<span class="string">"tcp://0.0.0.0:18217"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Service</span> <span class="attr">name</span>=<span class="string">"ptopmd"</span> <span class="attr">item</span>=<span class="string">"2"</span> <span class="attr">address</span>=<span class="string">"tcp://0.0.0.0:18219"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">Services</span>&gt;</span></span><br><span class="line">        <span class="tag">&lt;<span class="name">Databases</span>&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Database</span> <span class="attr">name</span>=<span class="string">"tinit"</span> <span class="attr">connectString</span>=<span class="string">"sjqh1"</span> <span class="attr">username</span>=<span class="string">"sync"</span> <span class="attr">password</span>=<span class="string">"sync"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Database</span> <span class="attr">name</span>=<span class="string">"tmdb"</span> <span class="attr">connectString</span>=<span class="string">"sjqh1"</span> <span class="attr">username</span>=<span class="string">"operation"</span> <span class="attr">password</span>=<span class="string">"operation"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Database</span> <span class="attr">name</span>=<span class="string">"sjqh"</span> <span class="attr">connectString</span>=<span class="string">"sjqh1"</span> <span class="attr">username</span>=<span class="string">"epayment2"</span> <span class="attr">password</span>=<span class="string">"epayment2"</span>/&gt;</span></span><br><span class="line">                <span class="tag">&lt;<span class="name">Database</span> <span class="attr">name</span>=<span class="string">"sjqh"</span> <span class="attr">connectString</span>=<span class="string">"sjqh1"</span> <span class="attr">username</span>=<span class="string">"fbexchange2"</span> <span class="attr">password</span>=<span class="string">"fbexchange2"</span>/&gt;</span></span><br><span class="line">        <span class="tag">&lt;/<span class="name">Databases</span>&gt;</span></span><br><span class="line"><span class="tag">&lt;/<span class="name">DeployConfig</span>&gt;</span></span><br></pre></td></tr></table></figure>

      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      
      
      

      

      
      
    </footer>
  </div>
  
  
  
  </article>



    <div class="post-spread">
      
    </div>
  </div>


          </div>
          


          

  



        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      
        <ul class="sidebar-nav motion-element">
          <li class="sidebar-nav-toc sidebar-nav-active" data-target="post-toc-wrap">
            文章目录
          </li>
          <li class="sidebar-nav-overview" data-target="site-overview-wrap">
            站点概览
          </li>
        </ul>
      

      <section class="site-overview-wrap sidebar-panel">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <p class="site-author-name" itemprop="name">Vagitus</p>
              <p class="site-description motion-element" itemprop="description">Just A Blog</p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/%20%7C%7C%20archive">
              
                  <span class="site-state-item-count">1</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            

            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      
      <!--noindex-->
        <section class="post-toc-wrap motion-element sidebar-panel sidebar-panel-active">
          <div class="post-toc">

            
              
            

            
              <div class="post-toc-content"><ol class="nav"><li class="nav-item nav-level-1"><a class="nav-link" href="#CTP-二代期货系统部署指南"><span class="nav-number">1.</span> <span class="nav-text">CTP 二代期货系统部署指南</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#系统基础环境搭建"><span class="nav-number">1.1.</span> <span class="nav-text">系统基础环境搭建</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#数据库-柜台部署"><span class="nav-number">1.2.</span> <span class="nav-text">数据库,柜台部署</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#安装-oracle-数据库"><span class="nav-number">1.2.1.</span> <span class="nav-text">安装 oracle 数据库</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#数据库数据恢复"><span class="nav-number">1.2.2.</span> <span class="nav-text">数据库数据恢复</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#柜台搭建"><span class="nav-number">1.2.3.</span> <span class="nav-text">柜台搭建</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#交易系统部署"><span class="nav-number">1.3.</span> <span class="nav-text">交易系统部署</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#组件部署"><span class="nav-number">1.3.1.</span> <span class="nav-text">组件部署</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#冒烟测试"><span class="nav-number">1.3.2.</span> <span class="nav-text">冒烟测试</span></a></li></ol></li><li class="nav-item nav-level-2"><a class="nav-link" href="#风控系统部署"><span class="nav-number">1.4.</span> <span class="nav-text">风控系统部署</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#结算-开户工具部署"><span class="nav-number">1.5.</span> <span class="nav-text">结算,开户工具部署</span></a><ol class="nav-child"><li class="nav-item nav-level-3"><a class="nav-link" href="#准备工作-均在-trade-用户"><span class="nav-number">1.5.1.</span> <span class="nav-text">准备工作 (均在 trade 用户)</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#upload-工具-部署"><span class="nav-number">1.5.2.</span> <span class="nav-text">upload 工具 部署</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#backup-sett-data-工具-部署"><span class="nav-number">1.5.3.</span> <span class="nav-text">backup_sett_data 工具 部署</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#mainapi-工具-部署"><span class="nav-number">1.5.4.</span> <span class="nav-text">mainapi 工具 部署</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#genfile-工具-部署"><span class="nav-number">1.5.5.</span> <span class="nav-text">genfile 工具 部署</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#gencffexfile-工具-部署"><span class="nav-number">1.5.6.</span> <span class="nav-text">gencffexfile 工具 部署</span></a></li><li class="nav-item nav-level-3"><a class="nav-link" href="#genclientfile-工具-部署"><span class="nav-number">1.5.7.</span> <span class="nav-text">genclientfile 工具 部署</span></a></li></ol></li></ol></li><li class="nav-item nav-level-1"><a class="nav-link" href="#附录"><span class="nav-number">2.</span> <span class="nav-text">附录</span></a><ol class="nav-child"><li class="nav-item nav-level-2"><a class="nav-link" href="#附录-1-网络-IP-配置"><span class="nav-number">2.1.</span> <span class="nav-text">附录 1: 网络 IP 配置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#附录-2-etc-hosts-配置"><span class="nav-number">2.2.</span> <span class="nav-text">附录 2: &#x2F;etc&#x2F;hosts 配置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#附录-3-list-配置"><span class="nav-number">2.3.</span> <span class="nav-text">附录 3: list 配置</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#附录-4-DeployConfig-xml"><span class="nav-number">2.4.</span> <span class="nav-text">附录 4: DeployConfig.xml</span></a></li></ol></li></ol></div>
            

          </div>
        </section>
      <!--/noindex-->
      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2020</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">Vagitus</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Muse</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  
  <script type="text/javascript" src="/js/src/scrollspy.js?v=5.1.4"></script>
<script type="text/javascript" src="/js/src/post-details.js?v=5.1.4"></script>



  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
